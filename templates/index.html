<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram Mini App</title>
    <style>
        body { margin: 0; overflow: hidden; background: #f0f8ff; position: relative; }
        .ball {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: red;
        }
        .add-button {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #0088cc; /* Telegram color */
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            z-index: 10; /* Для того чтобы кнопка отображалась поверх шариков */
        }
    </style>
</head>
<body>
    <button class="add-button" onclick="addBall()">Добавить шарик</button>

    <script>
        const balls = [];

        function createBall() {
            const ball = document.createElement('div');
            ball.classList.add('ball');
            document.body.appendChild(ball);

            // Начальные параметры движения и скорости
            const ballObj = {
                element: ball,
                x: window.innerWidth / 2,
                y: window.innerHeight / 2,
                velocityX: 0,
                velocityY: 0,
                gravity: 0.1,
                friction: 0.99
            };
            balls.push(ballObj);
        }

        function addBall() {
            createBall();
        }

        // Функция обновления физики и применения силы наклона устройства
        function updatePhysics() {
            balls.forEach(ball => {
                // Применяем гравитацию и замедление
                ball.velocityY += ball.gravity;
                ball.velocityX *= ball.friction;
                ball.velocityY *= ball.friction;

                // Обновляем позицию
                ball.x += ball.velocityX;
                ball.y += ball.velocityY;

                // Проверка на столкновение с краями экрана
                if (ball.x <= 0 || ball.x + 50 >= window.innerWidth) {
                    ball.velocityX *= -1; // Отскок по x
                    ball.x = Math.max(0, Math.min(ball.x, window.innerWidth - 50));
                }

                if (ball.y <= 0 || ball.y + 50 >= window.innerHeight) {
                    ball.velocityY *= -1; // Отскок по y
                    ball.y = Math.max(0, Math.min(ball.y, window.innerHeight - 50));
                }

                // Обновляем стиль элемента для новой позиции
                ball.element.style.left = `${ball.x}px`;
                ball.element.style.top = `${ball.y}px`;
            });
            requestAnimationFrame(updatePhysics);
        }

        // Начальное создание шарика
        createBall();
        updatePhysics();

        // Обработка наклона устройства
        window.addEventListener('deviceorientation', (event) => {
            const tiltX = event.gamma; // Наклон влево/вправо
            const tiltY = event.beta;  // Наклон вперёд/назад

            balls.forEach(ball => {
                // Учитываем наклон для добавления движения по осям x и y
                ball.velocityX += tiltX * 0.05;
                ball.velocityY += tiltY * 0.05;
            });
        });
    </script>
</body>
</html>
